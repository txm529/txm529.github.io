webpackJsonp([645],{iHnM:function(t,s,i){"use strict";Object.defineProperty(s,"__esModule",{value:!0});var e=i("4YfN"),a=i.n(e),o={data:function(){return{reddec:"",img:"",dec:"",show:!1,nonetworkimg:"",nonetworktext:"",door_id:"",iaaa_token:"",cademic:"",schoolLogo:"",schoolname:"",time:"",desc:"",base:{},showinfo:!1,door:{id:"",name:"",remark:""},otherData:"",citys:"",relate_code:"1",show_code:"0",open_level:"0",direction:"0",code_text:"未见异常",canAccess:!1,code_color:"green",picpku:"",tw:"",isXiaowai:!1,reason:"",twpopctrl:!1,tws:"",twdoubleCtrl:!1,ajaxlock:!1,errorpopctrl:!1,logid:"",listCtrl:!1,ind:0,list:[],pageLock:!1,text:"",token:"",hscjyyToken:"",show_jkb:2,jkb_info:{has_info:"",color:"",popup:"",days:"",ymjzs:"",one_ymcs:"",one_jzsj:"",two_ymcs:"",two_jzsj:"",three_ymcs:"",three_jzsj:""},ympopCtrl:!1}},created:function(){if(void 0==this.getUrlInfo().door_id)return this.show=!0,this.nonetworktext="页面不存在",void(this.nonetworkimg="/site/static/images/network.png");this.door_id=this.getUrlInfo().door_id,this.getUrlInfo().iaaa_token&&(this.iaaa_token=this.getUrlInfo().iaaa_token),this.img="/site/static/images/load.gif",this.dec="加载中",this.ajaxs()},watch:{},methods:{isMobile:function(){var t=navigator.userAgent.toLowerCase(),s="ipad"==t.match(/ipad/i),i="iphone os"==t.match(/iphone os/i),e="midp"==t.match(/midp/i),a="rv:1.2.3.4"==t.match(/rv:1.2.3.4/i),o="ucweb"==t.match(/ucweb/i),n="android"==t.match(/android/i),c="windows ce"==t.match(/windows ce/i),r="windows mobile"==t.match(/windows mobile/i);return!!(s||i||e||a||o||n||c||r)},geths:function(){window.location.href="https://hsyy.pku.edu.cn/hscjyy/portalSSOLogin.do?moduleId=history&token="+this.hscjyyToken},jump:function(){window.location.href="https://simso.pku.edu.cn/pages/index.html?page=sadEpidemicAccess.html&token="+this.token},getlistdata:function(t){this.listCtrl=!0,this.ind=t,$(".record-list>ul").scrollTop(0),this.list=[],this.text="加载中",this.getlist()},scroll:function(t){var s=t.currentTarget;if($(s).height()+$(s).scrollTop()>=$(s)[0].scrollHeight-40){if(this.pageLock)return!1;this.pageLock=!0,this.getlist("scroll")}},getlist:function(t){var s=this;"scroll"==t?this.page++:this.page=1;t=1==this.ind?1:0,this.appFetch({method:"get",url:"pkuhealthcodelog",data:{page:this.page,pagezize:20,type:t}},function(i){0==i.e?("scroll"==t?s.list=s.list.concat(i.d.list):(s.list=i.d.list,0==s.list.length&&(s.text="暂无记录")),i.d.list.length<20?s.pageLock=!0:s.pageLock=!1):(s.img="/site/static/images/cha.png",s.dec=i.m,s.pageLock=!1),setTimeout(function(){s.img="",s.dec=""},1500)},function(){s.pageLock=!1,s.img="/site/static/images/cha.png",s.dec="网络错误",setTimeout(function(){s.img="",s.dec=""},1500)},2)},hidepop:function(){this.isXiaowai||(this.twpopctrl=!1),this.errorpopctrl=!1},hideXgh:function(t){var s=t.length;return t.substring(0,3)+"***"+t.substring(s-3,s)},getUrlInfo:function(){var t={};return(location.href.split("?")[1]?location.href.split("?")[1].split("&"):[]).map(function(s){t[s.split("=")[0]]=s.split("=")[1]}),t},ajaxs:function(){var t=this;this.appFetch({method:"post",url:"pkuhealthcodemasterGetinfo",data:{door_id:this.door_id,iaaa_token:this.iaaa_token}},function(s){0==s.e?(""!=s.d.title?document.title=s.d.title:document.title="健康码",t.show_code=s.d.show_code,t.citys=s.d.city,t.base=s.d.user,t.rules=s.d.rules,t.logid=s.d.logid,t.condition=s.d.condition,t.relate_code=s.d.relate_code,t.open_level=s.d.open_level,t.direction=s.d.direction,t.isXiaowai=s.d.isXiaowai,t.token=s.d.token?s.d.token:"",t.hscjyyToken=s.d.hscjyyToken?s.d.hscjyyToken:"",t.isXiaowai&&(t.twpopctrl=!0),t.canAccess=s.d.canAccess,t.reason=s.d.reason,t.canAccess||(t.code_text="限制通行"),t.getpic(),s.d.door&&(t.door=s.d.door),t.code_color=s.d.leavedata.color?s.d.leavedata.color:"green",t.time=s.d.time,s.d.show_jkb&&(t.show_jkb=s.d.show_jkb,s.d.jkb_info&&(t.jkb_info=s.d.jkb_info))):(t.img="",t.dec="",t.show=!0,t.nonetworktext=s.e+"</br>"+s.m,t.nonetworkimg="/site/static/images/xitongcuowu.png")},function(){t.img="",t.dec="",t.show=!0,t.nonetworktext="网络错误",t.nonetworkimg="/site/static/images/network1.png"},1),this.appFetch({method:"get",url:"getinfo",data:{}},function(s){0==s.e?(t.schoolLogo=s.d.site_logo,t.schoolname=s.d.school_name,Vue.nextTick(function(){var t=$(window).height();$(".center-qrcode").outerHeight(t)})):(t.show=!0,t.nonetworktext=s.e+"</br>"+s.m,t.nonetworkimg="/site/static/images/xitongcuowu.png")},function(){t.show=!0,t.nonetworktext="网络错误",t.nonetworkimg="/site/static/images/network1.png"},1)},getpic:function(){var t=this;this.appFetch({method:"get",url:"healthpkuPic",data:{}},function(s){t.img="",t.dec="",0==s.e?(t.show=!1,t.showinfo=!0,s.d.pic?t.picpku="data:image/jpg;base64,"+s.d.pic:t.picpku=t.base.avatar):(t.show=!0,t.nonetworktext=s.e+"</br>"+s.m,t.nonetworkimg="/site/static/images/xitongcuowu.png")},function(){t.img="",t.dec="",t.show=!0,t.nonetworktext="网络错误",t.nonetworkimg="/site/static/images/network1.png"},1)},gettw:function(){this.tw||(this.twpopctrl=!0,this.listCtrl=!1,this.ind=0)},btntw:function(t){var s=this;""!=this.tws?/^(3\d|4[0-5])(\.\d)?$/.test(this.tws)?1==t&&this.tws>37.2?this.twdoubleCtrl=!0:this.ajaxlock||(this.ajaxlock=!0,this.img="/site/static/images/load.gif",this.dec="加载中",this.appFetch({method:"post",url:"pkutwhealthcode",data:{logid:this.logid,tw:this.tws}},function(t){s.ajaxlock=!1,0==t.e?(s.twdoubleCtrl=!1,s.tw=s.tws,s.img="/site/static/images/successload.png",s.dec="提交成功",s.twpopctrl=!1):(s.img="/site/static/images/cha.png",s.dec=t.m),setTimeout(function(){s.img="",s.dec=""},1500)},function(){s.ajaxlock=!1,s.img="/site/static/images/cha.png",s.dec="网络错误",setTimeout(function(){s.img="",s.dec=""},1500)},2)):this.reddec="体温填写不正确":this.reddec="请填写体温"}},mounted:function(){var t=this;window.addEventListener("pageshow",function(){t.isPageHide&&window.location.reload()}),window.addEventListener("pagehide",function(){t.isPageHide=!0})}},n=i("6RUx"),c=i("UjTL"),r=i("fwLW"),l=i("04HP"),d=a()({name:"masterqrcode",components:{gUserinfo:n.a,network:c.a,redhint:l.a,pophint:r.default}},o),p={render:function(){var t=this,s=t.$createElement,i=t._self._c||s;return i("div",{staticClass:"puknewQrcode"},[!t.show&&t.showinfo?i("div",[i("div",{staticClass:"epide_outer"},[t.isMobile()?t._e():i("div",{staticClass:"logo"},[i("span",[t._v("北大健康码")])])]),t._v(" "),i("div",{staticClass:"content mastercontent",class:{has_title:!t.isMobile()}},[i("div",{staticClass:"location_tit"},[i("div",{staticClass:"qrcode-wrap master"},[i("div",{staticClass:"title-master"},[i("img",{attrs:{src:"/site/static/images/qrcode/log.png",alt:""}}),t._v(" "),i("span",[t._v(t._s(t.time.split(" ")[0].split("-")[0])+"年"+t._s(t.time.split(" ")[0].split("-")[1])+"月"+t._s(t.time.split(" ")[0].split("-")[2])+"日 "+t._s(t.time.split(" ")[1]))])]),t._v(" "),i("div",{staticClass:"nocode-wrap"},[i("img",{staticClass:"border",attrs:{src:"/site/static/images/qrcode/border2.gif",alt:""}}),t._v(" "),i("img",{staticClass:"photo",attrs:{src:t.picpku,alt:""}})]),t._v(" "),i("p",{staticClass:"green state"},[t.canAccess?i("img",{attrs:{src:"/site/static/images/qrcode/right.png",alt:""}}):t._e(),t._v(" "),i("span",{class:{active:!t.canAccess}},[t._v(t._s(t.code_text))]),t._v(" "),t.canAccess?t._e():i("img",{attrs:{src:"/site/static/images/qrcode/wen.png",alt:""},on:{click:function(s){s.stopPropagation(),t.errorpopctrl=!0}}})]),t._v(" "),i("ul",{staticClass:"user-info flex"},[i("li",[i("span",[t._v(t._s(t.base.departs)+"  "+t._s(t.base.realname))])]),t._v(" "),i("li",[i("span",[t._v(t._s(t.hideXgh(t.base.role.number)))])])]),t._v(" "),i("ul",{staticClass:"user-info flex"},[i("li",[i("span",[t._v("位置：")]),t._v(" "),i("span",[t._v(t._s(t.door.name))])]),t._v(" "),i("li",{directives:[{name:"show",rawName:"v-show",value:t.tw,expression:"tw"}]},[i("span",{staticStyle:{color:"#5EBF42"}},[t._v(t._s(t.tw)+"℃")])])])]),t._v(" "),1==t.show_jkb?i("div",{staticClass:"jkb-wrap jkb-status-wrap"},[i("div",{staticClass:"jkb-status-wrap-line"}),t._v(" "),i("div",{staticClass:"jkb-status-wrap-top",class:{blue:"弹窗"==t.jkb_info.color,red:"红色"==t.jkb_info.color,green:"绿色"==t.jkb_info.color,yellow:"黄色"==t.jkb_info.color}},[i("div",{staticClass:"jkb-status-wrap-top-title"},[t._v("\n                健康宝状态：\n                "),1==t.jkb_info.has_info?i("span",[t._v(t._s(t.jkb_info.color))]):i("span",{staticClass:"no-jkzt"},[t._v("未查询到健康宝状态")])]),t._v(" "),"弹窗"==t.jkb_info.color?i("div",{staticClass:"jkb-status-wrap-top-desc"},[t._v("\n                "+t._s(t.jkb_info.popup)+"\n              ")]):t._e()]),t._v(" "),i("div",{staticClass:"jkb-status-sh-wrap"},[i("div",{staticClass:"jkb-status-sh-wrap-div"},[i("div",{class:{sh:""!==t.jkb_info.days&&t.jkb_info.days>=0&&t.jkb_info.days<=7}},[i("div",{staticClass:"jkb-status-sh-wrap-div-top"},[t._v("\n                    核酸检测结果\n                  ")]),t._v(" "),i("div",{staticClass:"jkb-status-sh-wrap-div-bottom"},[""===t.jkb_info.days?i("span",{staticClass:"jkb-status-sh-wrap-div-bottom-gray"},[t._v("未查询到结果")]):t._e(),t._v(" "),t.jkb_info.days>7?i("span",{staticClass:"jkb-status-sh-wrap-div-bottom-gray"},[t._v("7天内无记录")]):t._e(),t._v(" "),""!==t.jkb_info.days&&t.jkb_info.days>=0&&t.jkb_info.days<=7?i("div",{staticClass:"jkb-status-sh-wrap-div-bottom-blue"},[i("span",{staticClass:"firs"},[t._v("阴性")]),i("em",[t._v(t._s(t.jkb_info.days))]),i("span",[t._v("天")])]):t._e()])])]),t._v(" "),i("div",{staticClass:"jkb-status-sh-wrap-div"},[i("div",{class:{ym:t.jkb_info.ymjzs>0}},[i("div",{staticClass:"jkb-status-sh-wrap-div-top"},[t._v("\n                    疫苗接种情况 "),t.jkb_info.ymjzs>0?i("i",{staticClass:"icon iconfont icon-you",on:{click:function(s){t.ympopCtrl=!0}}}):t._e()]),t._v(" "),i("div",{staticClass:"jkb-status-sh-wrap-div-bottom"},[0==t.jkb_info.ymjzs?i("span",{staticClass:"jkb-status-sh-wrap-div-bottom-gray"},[t._v("未查询到结果")]):i("div",{staticClass:"jkb-status-sh-wrap-div-bottom-blue"},[i("span",[t._v("已接种")]),i("em",[t._v(t._s(t.jkb_info.ymjzs))]),i("span",[t._v("针")])])])])])])]):t._e(),t._v(" "),i("div",{staticClass:"jkb-wrap tw",class:{showlist:t.listCtrl}},[i("div",{staticClass:"fl"},[i("span",{on:{click:function(s){return s.stopPropagation(),t.gettw()}}},[t._v("体温登记")]),t._v(" "),i("span",{staticStyle:{display:"block","margin-top":"10px"},on:{click:function(s){return s.stopPropagation(),t.geths()}}},[t._v("核酸检测")])]),t._v(" "),i("div",[i("span",{class:{red:t.listCtrl&&1==t.ind},on:{click:function(s){return t.getlistdata("1")}}},[t._v("我的体温")])]),t._v(" "),i("div",[i("span",{class:{red:t.listCtrl&&2==t.ind},on:{click:function(s){return t.getlistdata("2")}}},[t._v("出入楼扫码")])])]),t._v(" "),t.listCtrl?i("div",{staticClass:"record-list"},[i("ul",{on:{scroll:function(s){return t.scroll(s)}}},[0==t.list.length?i("li",{staticClass:"active nodat",staticStyle:{"text-align":"center"}},[t._v(t._s(t.text))]):t._l(t.list,function(s,e){return i("li",{key:e,class:{active:t.list.length-1==e}},[i("div",{staticClass:"fl"},[i("i"),i("span",[t._v(t._s(s.created))])]),t._v(" "),1==t.ind?i("div",{staticClass:"fr"},[i("span",[t._v(t._s(s.tw))])]):t._e(),t._v(" "),2==t.ind?i("div",{staticClass:"fr"},[i("span",[t._v(t._s(s.door))])]):t._e()])})],2),t._v(" "),i("div",{staticClass:"record-down",on:{click:function(s){t.listCtrl=!1,t.ind=0}}},[t._v("收起"),i("i",{staticClass:"icon iconfont icon-shouqi"})])]):t._e(),t._v(" "),i("div",{staticClass:"jkb-wrap",on:{click:function(s){return t.jump()}}},[t._m(0),t._v(" "),t._m(1)]),t._v(" "),t._m(2),t._v(" "),t._m(3)])]),t._v(" "),t.twpopctrl?i("div",{staticClass:"pku-pop",on:{click:function(s){return t.hidepop()}}},[i("div",{staticClass:"pku-wrap",on:{click:function(t){t.stopPropagation()}}},[i("p",[t._v("体温登记")]),t._v(" "),i("div",[i("input",{directives:[{name:"model",rawName:"v-model",value:t.tws,expression:"tws"}],attrs:{type:"number"},domProps:{value:t.tws},on:{input:function(s){s.target.composing||(t.tws=s.target.value)}}}),i("span",[t._v("℃")])]),t._v(" "),i("span",[t._v("例如：36.8℃")]),t._v(" "),i("a",{attrs:{href:"javascript:;"},on:{click:function(s){return t.btntw("1")}}},[t._v("确定提交")])])]):t._e(),t._v(" "),t.twdoubleCtrl?i("div",{staticClass:"pku-pop",staticStyle:{"z-index":"10"}},[i("div",{staticClass:"tw-wraing"},[t._m(4),t._v(" "),i("span",[t._v("您的体温已超过37.2℃，请确认是否提交")]),t._v(" "),i("div",{staticClass:"foot"},[i("a",{staticClass:"ctrl-btn",attrs:{href:"javascript:;"},on:{click:function(s){t.twdoubleCtrl=!1}}},[t._v("返回修改")]),t._v(" "),i("a",{staticClass:"sure-btn",attrs:{href:"javascript:;"},on:{click:function(s){return t.btntw("2")}}},[t._v("确定提交")])])])]):t._e(),t._v(" "),t.errorpopctrl?i("div",{staticClass:"pku-pop"},[i("div",{staticClass:"pku-errorwrap"},[i("p",[t._v("原因")]),t._v(" "),i("span",[t._v(t._s(t.reason))]),t._v(" "),i("a",{attrs:{href:"javascript:;"},on:{click:function(s){t.errorpopctrl=!1}}},[t._v("确定")])])]):t._e()]):t._e(),t._v(" "),t.ympopCtrl?i("div",{staticClass:"ym-pop"},[i("div",{staticClass:"ym-pop-wrap"},[i("div",{staticClass:"ym-pop-wrap-title"},[t._v("\n\t\t\t\t\t疫苗接种情况"),i("img",{attrs:{src:"/site/static/images/qrcode/close.png",alt:""},on:{click:function(s){t.ympopCtrl=!1}}})]),t._v(" "),i("div",{staticClass:"ym-pop-wrap-tip"},[i("img",{attrs:{src:"/site/static/images/qrcode/tip.png",alt:""}}),t._v(" "),3==t.jkb_info.ymjzs?i("span",[t._v("已完成全部疫苗接种")]):i("span",[t._v("已完成"+t._s(t.jkb_info.ymjzs)+"针疫苗接种")])]),t._v(" "),i("div",{staticClass:"ym-pop-wrap-center"},[t.jkb_info.three_ymcs?i("div",{staticClass:"ym-pop-wrap-center-div"},[t._m(5),t._v(" "),i("div",{staticClass:"ym-pop-wrap-center-div-bot"},[i("div",[i("span",[t._v("疫苗厂商：")]),i("em",[t._v(t._s(t.jkb_info.three_ymcs))])]),t._v(" "),i("div",[i("span",[t._v("接种日期：")]),i("em",[t._v(t._s(t.jkb_info.three_jzsj))])])])]):t._e(),t._v(" "),t.jkb_info.two_ymcs?i("div",{staticClass:"ym-pop-wrap-center-div"},[t._m(6),t._v(" "),i("div",{staticClass:"ym-pop-wrap-center-div-bot"},[i("div",[i("span",[t._v("疫苗厂商：")]),i("em",[t._v(t._s(t.jkb_info.two_ymcs))])]),t._v(" "),i("div",[i("span",[t._v("接种日期：")]),i("em",[t._v(t._s(t.jkb_info.two_jzsj))])])])]):t._e(),t._v(" "),t.jkb_info.one_ymcs?i("div",{staticClass:"ym-pop-wrap-center-div"},[t._m(7),t._v(" "),i("div",{staticClass:"ym-pop-wrap-center-div-bot"},[i("div",[i("span",[t._v("疫苗厂商：")]),i("em",[t._v(t._s(t.jkb_info.one_ymcs))])]),t._v(" "),i("div",[i("span",[t._v("接种日期：")]),i("em",[t._v(t._s(t.jkb_info.one_jzsj))])])])]):t._e()])])]):t._e(),t._v(" "),t.show?i("network",{attrs:{nonetworkimg:t.nonetworkimg,nonetworktext:t.nonetworktext}}):t._e(),t._v(" "),i("pophint",{attrs:{img:t.img,dec:t.dec,appkey:"healthcode"}}),t._v(" "),i("redhint",{attrs:{reddec:t.reddec}})],1)},staticRenderFns:[function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"fl"},[s("img",{attrs:{src:"/site/static/images/qrcode/crxba.png"}})])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"fr"},[s("span",[this._v("出入校备案")]),this._v(" "),s("span",[this._v("点击前往出入校备案")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"jkb-wrap"},[s("div",{staticClass:"fl"},[s("img",{attrs:{src:"/site/static/images/qrcode/jkb.png"}})]),this._v(" "),s("div",{staticClass:"fr"},[s("span",[this._v("北京健康宝")]),this._v(" "),s("span",[this._v("长按可以识别并打开健康宝")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"jkb-wrap"},[s("div",{staticClass:"fl"},[s("img",{attrs:{src:"/site/static/images/qrcode/face.png"}})]),this._v(" "),s("div",{staticClass:"fr"},[s("span",[this._v("北大人脸采集")]),this._v(" "),s("span",[this._v("长按可以识别并打开北大人脸采集")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("i",{staticClass:"icon iconfont icon-form_iconzhuyi"})])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"ym-pop-wrap-center-div-title"},[s("span",[this._v("第三剂")]),this._v(" "),s("span",[this._v("Completed")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"ym-pop-wrap-center-div-title"},[s("span",[this._v("第二剂")]),this._v(" "),s("span",[this._v("Completed")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"ym-pop-wrap-center-div-title"},[s("span",[this._v("第一剂")]),this._v(" "),s("span",[this._v("Completed")])])}]},_=i("C7Lr")(d,p,!1,null,null,null);s.default=_.exports}});